= DeliverIt API Documentation
:toc: right
:toclevels: 2
:version: 1.0

== Overview

This API allows you to manage delivery orders and their associated order-groups. Features include creating and retrieving both order-groups and individual delivery orders.

== Base URL

The base URL for the API is `http://external.deliveritmy.com`.

== Authentication

Use your API token in the `Authorization` header like this:

----
Authorization: Bearer YOUR_API_TOKEN
----


== Create Order-Groups

Creates a new order group for delivery.

----
POST /order-groups
----

.Request Body
|===
| Name            | Type     | Description                                               | Required
| name            | string   | The name or description of the order group.               | Yes
| pickup_location | location | The pickup location for the order group. See <<Location>> | Yes
|===

.Request Example
[source,json]
----
{
  "name": "Afternoon Deliveries",
  "pickup_location": 
  {
    "longitude": 123.456,
    "latitude": 123.456
  }
}
----

.Response Body
|===
| Name        | Type    | Description
| id          | int     | Unique identifier for the newly created order group.
| name        | string  | The name or description of the order group.
| status      | string  | Current status of the order group. See <<Order Group Status>>
| created_at  | string  | Timestamp indicating when the order group was created.
| updated_at  | string  | Timestamp indicating the last time the order group was updated.
|===

.Response Example
[source,json]
{
  "id": 4,
  "name": "Afternoon Deliveries",
  "pickup_location": 
  {
    "longitude": 123.456,
    "latitude": 123.456
  },
  "status": "OPEN",
  "created_at": "2023-01-01T12:34:56Z",
  "updated_at": "2023-01-02T12:34:56Z"
}


== Get Order-Groups

Retrieves details of a specific order-group.

----
GET /order-groups/:group_id
----

.Path Parameters
group_id::
  - Type: `int`
  - Description: ID of the order-group to retrieve

.Response Example
[source,json]
{
  "id": 4,
  "name": "Afternoon Deliveries",
  "pickup_location": 
  {
    "longitude": 123.456,
    "latitude": 123.456
  },
  "status": "OPEN",
  "created_at": "2023-01-01T12:34:56Z",
  "updated_at": "2023-01-02T12:34:56Z"
}


== Create Delivery Orders

Creates a new delivery order within a specific order-group.

----
POST /order-groups/:group_id/orders
----

.Path Parameters
group_id::
  - Type: `int`
  - Description: ID of the order-group to retrieve

.Request Parameters Table:
|===
| Name    | Type   | Description
| address | string | Delivery address
| status  | string | Delivery status (e.g., "Pending", "Delivered")
|===

.Response Example
[source,json]
----
{
  "id": 3,
  "address": "789 Oak St",
  "status": "Pending"
}
----


== Get Delivery Orders

Retrieves details of a specific delivery order within a given order-group.

----
GET /order-groups/:group_id/orders/:id
----

.Path Parameters
group_id::
  - Type: `int`
  - Description: ID of the order-group to retrieve
id::
  - Type: `int`
  - Description: ID of the specific delivery order within the order-group

.Response Fields Table
|===
| Field      | Type   | Description
| id         | int    | Unique identifier for the specific delivery order.
| address    | string | The address for the delivery.
| status     | string | Current status of the delivery order.
| created_at | string | Timestamp indicating when the delivery order was created.
| updated_at | string | Timestamp indicating the last time the delivery order was updated.
|===

.Response Example
[source,json]
----
{
  "id": 1,
  "address": "123 Main St",
  "status": "Pending",
  "created_at": "2023-01-01T12:34:56Z",
  "updated_at": "2023-01-02T12:34:56Z"
}
----


== Callback for Delivery Status Updates

The callback will be made to the `callback_url` provided in the POST request. The callback will include the following parameters:

|===
| Name               | Type   | Description
| status             | string | Delivery status (e.g., "Success", "Failed")
| proof_of_delivery  | string | A URL or identifier for proof of delivery (e.g., a photo, digital signature)
|===

.Callback Example
[source,json]
----
{
  "status": "Success",
  "proof_of_delivery": "https://example.com/proofs/1234.jpg"
}
----


== Order Group Status

An order group undergoes a series of stages, each represented by a distinct status. Though the status is a string, it can only assume the following specific values:

.Status and Descriptions
|===
| Status          | Description
| OPEN            | Initial stage with draft versions of pickup and drop-off tasks.
| CONFIRMED       | Pickup and drop-off tasks are finalized and forwarded to OnFleet for driver allocation.
| ASSIGNED        | A driver has been allocated for the pickup and drop-off tasks in the order group.
| IN_TRANSIT      | The driver has initiated the pickup and drop-off tasks; the orders are currently in transit.
| SUCCESS         | All tasks related to pickup and drop-off within the order group have been successfully completed.
| PARTIAL_SUCCESS | Mixed results for the pickup and drop-off tasks within the order group; some succeeded while others failed.
| FAILED          | All tasks related to pickup and drop-off within the order group were unsuccessful.
| CANCELLED       | All tasks related to pickup and drop-off within the order group have been cancelled.
|===


== Location 

The Location Object represents geographical coordinates, consisting of `longitude` and `latitude`.

.Location Properties
|===
| Name       | Type    | Description
| longitude  | double  | The longitude coordinate of the location
| latitude   | double  | The latitude coordinate of the location
|===